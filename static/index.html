<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Client Testing</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
  <div class="container mx-auto p-4">
    <h1 class="text-xl font-bold mb-4">API Client Testing</h1>

    <!-- Textarea for curl command input -->
    <textarea id="curlCommand" rows="5" class="w-full border mb-4 p-2" placeholder="Enter curl command"></textarea>
    <button id="executeBtn" class="bg-blue-500 text-white px-4 py-2">Execute</button>

    <!-- Response display -->
    <h2 class="text-lg font-bold mt-4">Response:</h2>
    <pre id="responseOutput" class="bg-gray-200 p-4 mt-2"></pre>

    <!-- History display -->
    <h2 class="text-lg font-bold mt-4">History:</h2>
    <ul id="historyList" class="mt-2"></ul>
  </div>

  <script>
    document.getElementById('executeBtn').addEventListener('click', async () => {
      const command = document.getElementById('curlCommand').value;
      const response = await fetch('/execute', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ command }),
      }).then(res => res.json());

      document.getElementById('responseOutput').innerText = response.response;
      loadHistory();  // Reload history after execution
    });

    async function loadHistory() {
      const history = await fetch('/history').then(res => res.json());
      const historyList = document.getElementById('historyList');
      historyList.innerHTML = '';
      history.forEach(item => {
        historyList.innerHTML += `<li>${item.Command} - ${item.Timestamp}</li>`;
      });
    }
    loadHistory();  // Initial load of history on page load
  </script>
</body>
</html>

